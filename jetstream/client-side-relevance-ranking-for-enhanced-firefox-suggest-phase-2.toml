[experiment]
enrollment_period = 7

[metrics]
weekly = ["wikipedia_dynamic_impressions", "wikipedia_enhanced_impressions", "admarketplace_sponsored_impressions", "search_suggestion_impressions", 
"wikipedia_dynamic_clicks", "wikipedia_enhanced_clicks", "admarketplace_sponsored_clicks", "search_suggestion_clicks", "wikipedia_dynamic_ctr", "wikipedia_enhanced_ctr", "admarketplace_sponsored_ctr", 
"search_suggestion_ctr"]
overall = ["wikipedia_dynamic_impressions", "wikipedia_enhanced_impressions", "admarketplace_sponsored_impressions", "search_suggestion_impressions", 
"wikipedia_dynamic_clicks", "wikipedia_enhanced_clicks", "admarketplace_sponsored_clicks", "search_suggestion_clicks", "wikipedia_dynamic_ctr", "wikipedia_enhanced_ctr", "admarketplace_sponsored_ctr", 
"search_suggestion_ctr"]

## Impressions
[metrics.wikipedia_dynamic_impressions]
select_expression = "SUM(IF(product_result_type = 'wikipedia_dynamic', urlbar_impressions, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.wikipedia_dynamic_impressions.statistics.bootstrap_mean]

[metrics.wikipedia_enhanced_impressions]
select_expression = "SUM(IF(product_result_type = 'wikipedia_enhanced', urlbar_impressions, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.wikipedia_enhanced_impressions.statistics.bootstrap_mean]

[metrics.admarketplace_sponsored_impressions]
select_expression = "SUM(IF(product_result_type = 'admarketplace_sponsored', urlbar_impressions, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.admarketplace_sponsored_impressions.statistics.bootstrap_mean]

[metrics.search_suggestion_impressions]
select_expression = "SUM(IF(product_result_type = 'default_partner_search_suggestion', urlbar_impressions, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.search_suggestion_impressions.statistics.bootstrap_mean]

[metrics.urlbar_impressions_suggest.statistics.bootstrap_mean]

## Clicks
[metrics.wikipedia_dynamic_clicks]
select_expression = "SUM(IF(product_result_type = 'wikipedia_dynamic', urlbar_clicks, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.wikipedia_dynamic_clicks.statistics.bootstrap_mean]

[metrics.wikipedia_enhanced_clicks]
select_expression = "SUM(IF(product_result_type = 'wikipedia_enhanced', urlbar_clicks, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.wikipedia_enhanced_clicks.statistics.bootstrap_mean]

[metrics.admarketplace_sponsored_clicks]
select_expression = "SUM(IF(product_result_type = 'admarketplace_sponsored', urlbar_clicks, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.admarketplace_sponsored_clicks.statistics.bootstrap_mean]

[metrics.search_suggestion_clicks]
select_expression = "SUM(IF(product_result_type = 'default_partner_search_suggestion', urlbar_clicks, 0))"
data_source = "urlbar_events_daily_engagement_by_product_result_type_v1"
[metrics.search_suggestion_clicks.statistics.bootstrap_mean]

## CTR
[metrics.wikipedia_dynamic_ctr]
depends_on = ["wikipedia_dynamic_clicks", "wikipedia_dynamic_impressions"]
friendly_name = "wikipedia_dynamic CTR"
description = "Proportion of urlbar sessions where suggestion from the user's browsing wikipedia_dynamic was clicked, out of all urlbar sessions where one was shown (not available on control)"

[metrics.wikipedia_dynamic_ctr.statistics.population_ratio]
numerator = "wikipedia_dynamic_clicks"
denominator = "wikipedia_dynamic_impressions"

[metrics.wikipedia_enhanced_ctr]
depends_on = ["wikipedia_enhanced_clicks", "wikipedia_enhanced_impressions"]
friendly_name = "wikipedia_enhanced CTR"
description = "Proportion of urlbar sessions where suggestion from the user's wikipedia_enhanceds was clicked, out of all urlbar sessions where one was shown (not available on control)"

[metrics.wikipedia_enhanced_ctr.statistics.population_ratio]
numerator = "wikipedia_enhanced_clicks"
denominator = "wikipedia_enhanced_impressions"

[metrics.admarketplace_sponsored_ctr]
depends_on = ["admarketplace_sponsored_clicks", "admarketplace_sponsored_impressions"]
friendly_name = "admarketplace_sponsored CTR"
description = "Proportion of urlbar sessions where suggestion from the user's admarketplace_sponsoreds was clicked, out of all urlbar sessions where one was shown (not available on control)"

[metrics.admarketplace_sponsored_ctr.statistics.population_ratio]
numerator = "admarketplace_sponsored_clicks"
denominator = "admarketplace_sponsored_impressions"

[metrics.search_suggestion_ctr]
depends_on = ["search_suggestion_clicks", "search_suggestion_impressions"]
friendly_name = "Search Suggestion CTR"
description = "Proportion of urlbar sessions where suggestion from the default search engine was clicked, out of all urlbar sessions where one was shown (not available on control)"

[metrics.search_suggestion_ctr.statistics.population_ratio]
numerator = "search_suggestion_clicks"
denominator = "search_suggestion_impressions"
